---
title: "Repro Spano et al 2018"
author: "mhorger"
date: "March 25, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction 
General summary of the article: 
- naps are beneficial for learning in typically developing infants, children, and adults. 
- individuals with Down syndrome have a high rate of disordered sleep than seen in the typical populaiton. Do they experience the same benefits of sleep on learning? 

- Methods - 
Assess retention of new words with various intervals between training and test. Children receive all conditions 1-2 weeks apart
1. after a 5 min delay
2. after a nap (4 hour delay)
3. after 24 hours 
- Planned analysis - 
The first analysis conducted was a repeated measures ANOVA for both wake and nap conditions. The second was a 2x2 ANOVA with delay type as the repeated factor and TD or DS as the between. These were conducted for the 4 and 24 hour delay. 

## Re-analysis 

### Pre-processing and conversion to long format 

```{r}

ChangeinRec <- c(as.numeric(unlist(Spano_et_al[,11])),
         as.numeric(unlist(Spano_et_al[,12])),
         as.numeric(unlist(Spano_et_al[,13])),
         as.numeric(unlist(Spano_et_al[,14]))
         )

Group <- 
  rep(c("DS"), 25)
Group<-
  c(Group, rep(c("TD"), 24))
Group<- 
  c(rep(Group, 4))

Subjects <- rep(seq(1:49), 4) 

Condition <- 
  rep(rep(c("WAKE", "SLEEP"), each = 49), 2)

Delay <- 
  rep(c(4, 24), each = 9)

Spano <- data.frame(Subjects, Group, Condition, Delay, ChangeinRec)

```

##Analysis 
The first analysis conducted was a repeated measures ANOVA for both wake and nap conditions.
```{r}
Spano$Subjects<- factor(Spano$Subjects)

class(Spano$Subjects)

ANOVA1<- aov(ChangeinRec~Condition + Error(Subjects/(Condition)), Spano)
summary(ANOVA1)
```

The second was a 2x2 ANOVA with delay type as the repeated factor and TD or DS as the between. These were conducted for the 4 and 24 hour delay. 

```{r}
Change4hr <- ChangeinRec[1:98]
Change24hr <- ChangeinRec[99:196]
GroupPerHr <- Group[1:98]
CondPerHr <- Condition[1:98]

TwentyFourHrDelay<- data.frame(Subjects,GroupPerHr, CondPerHr, Change24hr)

FourHrDelay <- data.frame(Subjects,GroupPerHr, CondPerHr, Change4hr)

ANOVA24<- aov(Change24hr~GroupPerHr*CondPerHr + Error(Subjects/(CondPerHr)), TwentyFourHrDelay) 
summary(ANOVA24)

ANOVA4 <-  aov(Change4hr~GroupPerHr*CondPerHr + Error(Subjects/(CondPerHr)), FourHrDelay) 
summary(ANOVA4)

summary_out_4HRS <- summary(ANOVA4)
library(xtable)
knitr::kable(xtable(summary_out_4HRS))


summary_out_24HRS <- summary(ANOVA24)
library(xtable)
knitr::kable(xtable(summary_out_24HRS))
```



## Reproducing the figure 

I will focus on the figure that depicts Repetitions required to meet criterion 

```{r}
NumToCriterion<- c(as.numeric(unlist(Spano_et_al[,7])),
         as.numeric(unlist(Spano_et_al[,8])),
         as.numeric(unlist(Spano_et_al[,9]))
         )
Timing<- rep(c("Immediate", "4 hours", "24 hours"), each = 49)

Subs <- rep(c(seq(1:49)), 3)
Subs<- as.factor(Subs)

FigureItOut <- data.frame()


ggplot(Spano, aes(x=Delay,
                          y=ChangeinRec, 
                          group=Condition,
                          fill=Group))+
  geom_bar(stat="identity",position="dodge")+
  theme_classic(base_size=12)+
  ylab("Mean Reaction Time (ms)")+
  geom_errorbar(aes(ymin=meanRT-SEMRT,
                    ymax=meanRT+SEMRT),
                position=position_dodge(width=0.9),
                width=.2,
                color="black")+
  coord_cartesian(ylim=c(750,1000))
```

